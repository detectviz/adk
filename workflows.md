# SRE Assistant çš„ ADK åˆ†é¡è©•ä¼°

æ ¹æ“š ADK ç¯„ä¾‹çš„åˆ†é¡æ¨™æº–ä¾†è©•ä¼° SRE Assistantï¼Œä¸¦ç¢ºèªå·¥ä½œæµç¨‹æ¨¡å¼çš„é©ç”¨æ€§ã€‚

### ğŸ“Š **SRE Assistant ç‰¹æ€§åˆ†é¡**

| å±¬æ€§ | SRE Assistant è©•ä¼° | ç†ç”± |
|------|-------------------|------|
| **ä»£ç†åç¨±** | SRE Assistant | æ™ºæ…§å‹ SRE åŠ©ç†ç³»çµ± |
| **ä½¿ç”¨æ¡ˆä¾‹** | è‡ªå‹•åŒ– SRE å·¥ä½œæµç¨‹ï¼šè¨ºæ–·ã€ä¿®å¾©ã€è¦†ç›¤ã€é…ç½®å„ªåŒ– | è™•ç†ç”Ÿç”¢ç’°å¢ƒäº‹ä»¶çš„å®Œæ•´ç”Ÿå‘½é€±æœŸ |
| **æ¨™ç±¤** | `Multi-agent`, `RAG`, `HITL`, `Monitoring`, `Kubernetes`, `Prometheus`, `GitHub`, `Workflow` | çµåˆå¤šç¨®æŠ€è¡“å’Œæ•´åˆ |
| **äº’å‹•é¡å‹** | **å·¥ä½œæµç¨‹ (Workflow)** | ä¸»è¦æ˜¯è‡ªå‹•åŒ–å·¥ä½œæµç¨‹ï¼Œæ¬¡è¦æ”¯æ´å°è©± |
| **è¤‡é›œåº¦** | **é€²éš (Advanced)** | å¤šä»£ç†å”ä½œã€è¤‡é›œç‹€æ…‹ç®¡ç†ã€å¤–éƒ¨æ•´åˆ |
| **ä»£ç†é¡å‹** | **å¤šä»£ç† (Multi Agent)** | 4å€‹å°ˆå®¶ä»£ç† + å”èª¿å™¨ |
| **å‚ç›´é ˜åŸŸ** | **DevOps/SRE** | å°ˆé–€é‡å°ç«™é»å¯é æ€§å·¥ç¨‹ |

### ğŸ” **è©³ç´°åˆ†æ**

#### 1. **äº’å‹•é¡å‹ï¼šç‚ºä½•æ˜¯ Workflow è€Œé Conversationalï¼Ÿ**

SRE Assistant çš„æ ¸å¿ƒè¨­è¨ˆæ˜¯ï¼š
- **äº‹ä»¶é©…å‹•**ï¼šç”±ç›£æ§å‘Šè­¦è§¸ç™¼ï¼Œä¸æ˜¯ç”±ç”¨æˆ¶å°è©±è§¸ç™¼
- **çµæ§‹åŒ–æµç¨‹**ï¼šè¨ºæ–· â†’ ä¿®å¾© â†’ è¦†ç›¤ â†’ å„ªåŒ–
- **è‡ªå‹•åŒ–åŸ·è¡Œ**ï¼šå¤§éƒ¨åˆ†æ“ä½œç„¡éœ€äººå·¥å¹²é 
- **æ‰¹æ¬¡è™•ç†**ï¼šè™•ç†å¤šå€‹ç›¸é—œäº‹ä»¶

é¡ä¼¼ç¯„ä¾‹ï¼š
- **FOMC Research** (Workflow, Advanced, Multi Agent)
- **Marketing Agency** (Workflow, Easy, Multi Agent)

#### 2. **è¤‡é›œåº¦ï¼šç‚ºä½•æ˜¯ Advancedï¼Ÿ**

ç¬¦åˆ Advanced çš„ç‰¹å¾µï¼š
- âœ… å¤šä»£ç†å”ä½œæ¶æ§‹ (4+ å°ˆå®¶ä»£ç†)
- âœ… è¤‡é›œç‹€æ…‹ç®¡ç† (Session + Memory)
- âœ… å¤–éƒ¨ç³»çµ±æ•´åˆ (Prometheus, K8s, GitHub)
- âœ… HITL å¯©æ‰¹æ©Ÿåˆ¶
- âœ… RAG çŸ¥è­˜æª¢ç´¢
- âœ… ä¸¦è¡Œå’Œå¾ªç’°åŸ·è¡Œ

é¡ä¼¼ç¯„ä¾‹ï¼š
- **Machine Learning Engineering** (Advanced, Multi Agent)
- **Academic Research** (Advanced, Multi Agent)

#### 3. **ä»£ç†é¡å‹ï¼šæ˜ç¢ºçš„ Multi Agent**

æ¶æ§‹è­‰æ“šï¼š
```python
# å¤šä»£ç†å”ä½œæ¶æ§‹
SRECoordinator (SequentialAgent)
â”œâ”€â”€ DiagnosticExpert (LlmAgent + RAG)
â”œâ”€â”€ RemediationExpert (LlmAgent + HITL)
â”œâ”€â”€ PostmortemExpert (LlmAgent)
â””â”€â”€ ConfigExpert (LlmAgent)
```

## ğŸ¯ **å·¥ä½œæµç¨‹æ¨¡å¼é©ç”¨æ€§è©•ä¼°**

### âœ… **é«˜åº¦é©åˆ google-adk-workflows**

åŸºæ–¼ä»¥ä¸Šè©•ä¼°ï¼ŒSRE Assistant **éå¸¸é©åˆ**æ¡ç”¨å·¥ä½œæµç¨‹æ¨¡å¼ï¼Œç†ç”±ï¼š

#### 1. **æ ¸å¿ƒæ˜¯ Workflow è€Œé Conversational**
```python
# SRE Assistant çš„æœ¬è³ªæ˜¯å·¥ä½œæµç¨‹
class EnhancedSREWorkflow(SequentialAgent):
    """äº‹ä»¶è™•ç†å·¥ä½œæµç¨‹"""
    
    def __init__(self):
        # éšæ®µ 1: ä¸¦è¡Œè¨ºæ–·ï¼ˆå€Ÿé¡ ParallelAgentï¼‰
        diagnostic_phase = ParallelAgent(
            name="parallel_diagnostics",
            sub_agents=[
                MetricsAnalyzer(),
                LogAnalyzer(),
                TraceAnalyzer()
            ]
        )
        
        # éšæ®µ 2: æ¢ä»¶ä¿®å¾©ï¼ˆå€Ÿé¡æ¢ä»¶åŸ·è¡Œï¼‰
        remediation_phase = ConditionalAgent(
            name="conditional_remediation",
            condition=lambda ctx: ctx.state['severity'],
            branches={
                'P0': EmergencyRemediationAgent(),
                'P1': StandardRemediationAgent(),
                'P2': ScheduledRemediationAgent()
            }
        )
        
        # éšæ®µ 3: è¿­ä»£å„ªåŒ–ï¼ˆå€Ÿé¡ LoopAgentï¼‰
        optimization_phase = LoopAgent(
            name="iterative_optimization",
            sub_agent=SLOTuningAgent(),
            termination_condition=lambda ctx: ctx.state['slo_met']
        )
        
        super().__init__(
            sub_agents=[
                diagnostic_phase,
                remediation_phase,
                PostmortemExpert(),
                optimization_phase
            ]
        )
```

#### 2. **èˆ‡é¡ä¼¼ Advanced Workflow ä»£ç†å°æ¯”**

| ç‰¹æ€§ | SRE Assistant | FOMC Research | ML Engineering |
|------|--------------|---------------|----------------|
| å·¥ä½œæµç¨‹é¡å‹ | âœ… Sequential + Parallel | âœ… Sequential | âœ… Loop + Parallel |
| å¤šä»£ç†å”ä½œ | âœ… 4+ å°ˆå®¶ | âœ… 6+ ä»£ç† | âœ… 5+ ä»£ç† |
| å¤–éƒ¨å·¥å…· | âœ… 10+ å·¥å…· | âœ… 8+ å·¥å…· | âœ… 5+ å·¥å…· |
| å‹•æ…‹æ±ºç­– | âœ… æ¢ä»¶åŸ·è¡Œ | âœ… å‹•æ…‹åˆ†æ | âœ… è¿­ä»£å„ªåŒ– |

#### 3. **å·¥ä½œæµç¨‹æ¨¡å¼çš„å…·é«”å„ªå‹¢**

```python
# å„ªå‹¢ 1: ä¸¦è¡Œè¨ºæ–·æå‡æ•ˆç‡
parallel_diagnostics = ParallelAgent(
    sub_agents=[PrometheusAgent(), ElasticsearchAgent(), JaegerAgent()]
)
# æ•ˆæœï¼šè¨ºæ–·æ™‚é–“å¾ 30ç§’ â†’ 10ç§’

# å„ªå‹¢ 2: æ¢ä»¶åŸ·è¡Œæå‡å®‰å…¨æ€§
if severity == 'P0' and environment == 'production':
    require_approval = True  # HITL å¯©æ‰¹

# å„ªå‹¢ 3: å¾ªç’°å„ªåŒ–æŒçºŒæ”¹é€²
while not slo_met and iterations < max_iterations:
    optimize_configuration()
```

## ğŸ“‹ **æœ€çµ‚å»ºè­°**

### 1. **ä¿æŒ Workflow ç‚ºä¸»çš„è¨­è¨ˆ**
- SRE Assistant çš„æ ¸å¿ƒåƒ¹å€¼åœ¨æ–¼**è‡ªå‹•åŒ–å·¥ä½œæµç¨‹**
- å°è©±åŠŸèƒ½æ‡‰è©²æ˜¯è¼”åŠ©æ€§çš„ï¼ˆæŸ¥è©¢ç‹€æ…‹ã€æ‰‹å‹•è§¸ç™¼ï¼‰

### 2. **å……åˆ†åˆ©ç”¨å·¥ä½œæµç¨‹æ¨¡å¼**
- **ç«‹å³æ¡ç”¨**ï¼šParallelAgent ç”¨æ–¼ä¸¦è¡Œè¨ºæ–·
- **å¿«é€Ÿå¯¦æ–½**ï¼šConditionalAgent ç”¨æ–¼é¢¨éšªåˆ†ç´š
- **é€æ­¥å¼•å…¥**ï¼šLoopAgent ç”¨æ–¼è¿­ä»£å„ªåŒ–

### 3. **åƒè€ƒåŒé¡ Advanced Workflow ä»£ç†**
- å­¸ç¿’ **FOMC Research** çš„å¤šéšæ®µå”èª¿
- å€Ÿé¡ **ML Engineering** çš„è¿­ä»£å„ªåŒ–
- åƒè€ƒ **Marketing Agency** çš„ä»»å‹™åˆ†è§£

### 4. **å¯¦æ–½å„ªå…ˆç´š**
```python
# P0: åŸºç¤å·¥ä½œæµç¨‹ï¼ˆ1-2é€±ï¼‰
basic_workflow = SequentialAgent([è¨ºæ–·, ä¿®å¾©, è¦†ç›¤])

# P1: ä¸¦è¡Œå’Œæ¢ä»¶ï¼ˆ3-4é€±ï¼‰
enhanced_workflow = SequentialAgent([
    ParallelAgent([å¤šå€‹è¨ºæ–·]),
    ConditionalAgent(é¢¨éšªè©•ä¼°),
    ä¿®å¾©,
    è¦†ç›¤
])

# P2: å®Œæ•´å·¥ä½œæµç¨‹ï¼ˆ5-8é€±ï¼‰
advanced_workflow = SequentialAgent([
    ParallelAgent([è¨ºæ–·çµ„]),
    ConditionalAgent(å‹•æ…‹æ±ºç­–),
    LoopAgent(è¿­ä»£ä¿®å¾©),
    è¦†ç›¤,
    LoopAgent(æŒçºŒå„ªåŒ–)
])
```

**çµè«–**ï¼šSRE Assistant ä½œç‚ºä¸€å€‹ **Advanced Workflow Multi-Agent** ç³»çµ±ï¼Œæ¡ç”¨ `google-adk-workflows` æ¨¡å¼æ˜¯**æœ€ä½³é¸æ“‡**ã€‚é€™ä¸åƒ…ç¬¦åˆå…¶æœ¬è³ªç‰¹æ€§ï¼Œé‚„èƒ½å……åˆ†ç™¼æ® ADK å·¥ä½œæµç¨‹ä»£ç†çš„å„ªå‹¢ã€‚

## åˆ†æ google-adk-workflows å° SRE Assistant çš„é©ç”¨æ€§

### ğŸ¯ **é«˜åº¦é©åˆçš„éƒ¨åˆ†**

#### 1. **å·¥ä½œæµç¨‹ç·¨æ’æ¨¡å¼**
`google-adk-workflows` æä¾›çš„å·¥ä½œæµç¨‹æ¨¡å¼éå¸¸é©åˆ SRE Assistantï¼š

```python
# SRE Assistant å¯ä»¥å€Ÿé¡çš„å·¥ä½œæµç¨‹çµæ§‹
class EnhancedSRECoordinator(SequentialAgent):
    """å¢å¼·çš„ SRE å”èª¿å™¨ - å€Ÿé¡ workflow æ¨¡å¼"""
    
    def __init__(self):
        # éšæ®µ 1: ä¸¦è¡Œè¨ºæ–·ï¼ˆå€Ÿé¡ ParallelAgentï¼‰
        diagnostic_parallel = ParallelAgent(
            name="parallel_diagnostics",
            sub_agents=[
                MetricsAnalyzer(),      # æŒ‡æ¨™åˆ†æ
                LogAnalyzer(),          # æ—¥èªŒåˆ†æ
                TraceAnalyzer(),        # è¿½è¹¤åˆ†æ
                HistoricalMatcher()     # æ­·å²äº‹ä»¶åŒ¹é…
            ]
        )
        
        # éšæ®µ 2: æ™ºèƒ½æ±ºç­–ï¼ˆå€Ÿé¡æ¢ä»¶åŸ·è¡Œï¼‰
        decision_agent = ConditionalAgent(
            name="remediation_decision",
            condition_checker=self.check_severity,
            high_severity_agent=ImmediateRemediationExpert(),
            low_severity_agent=ScheduledRemediationExpert()
        )
        
        # éšæ®µ 3: å¾ªç’°å„ªåŒ–ï¼ˆå€Ÿé¡ LoopAgentï¼‰
        optimization_loop = LoopAgent(
            name="slo_optimizer",
            sub_agent=SLOTuningAgent(),
            max_iterations=3,
            termination_condition=lambda ctx: ctx.state.get('slo_met', False)
        )
        
        super().__init__(
            name="enhanced_sre_coordinator",
            sub_agents=[
                diagnostic_parallel,    # ä¸¦è¡Œè¨ºæ–·
                decision_agent,        # æ¢ä»¶æ±ºç­–
                RemediationExpert(),   # åŸ·è¡Œä¿®å¾©
                optimization_loop,     # è¿­ä»£å„ªåŒ–
                PostmortemExpert()     # äº‹å¾Œåˆ†æ
            ]
        )
```

#### 2. **å‹•æ…‹å·¥ä½œæµç¨‹é¸æ“‡**
å€Ÿé¡ `workflow_triage` æ¨¡å¼å¯¦ç¾å‹•æ…‹ä»£ç†é¸æ“‡ï¼š

```python
class SRETriageManager(BaseAgent):
    """SRE æ™ºèƒ½åˆ†æµç®¡ç†å™¨"""
    
    def __init__(self):
        self.severity_mapping = {
            'P0': [SecurityExpert(), NetworkExpert(), DatabaseExpert()],
            'P1': [PerformanceExpert(), ConfigExpert()],
            'P2': [OptimizationExpert()]
        }
    
    async def _run_async_impl(self, ctx: InvocationContext):
        # åˆ†æäº‹ä»¶åš´é‡æ€§
        severity = await self.analyze_severity(ctx)
        
        # å‹•æ…‹é¸æ“‡å°ˆå®¶çµ„åˆ
        relevant_experts = self.severity_mapping.get(severity, [])
        
        # æ›´æ–°åŸ·è¡Œè¨ˆåŠƒ
        ctx.state['execution_plan'] = {
            'severity': severity,
            'active_experts': [e.name for e in relevant_experts],
            'skip_experts': self.get_irrelevant_experts(severity)
        }
        
        # ä¸¦è¡ŒåŸ·è¡Œç›¸é—œå°ˆå®¶
        if relevant_experts:
            parallel_executor = ParallelAgent(
                name="expert_execution",
                sub_agents=relevant_experts
            )
            async for event in parallel_executor.run_async(ctx):
                yield event
```

#### 3. **æ¢ä»¶åŸ·è¡Œå’Œæ—©æœŸçµ‚æ­¢**
å¯¦ç¾æ™ºèƒ½çš„æ¢ä»¶åŸ·è¡Œé‚è¼¯ï¼š

```python
class ConditionalRemediationAgent(BaseAgent):
    """æ¢ä»¶ä¿®å¾©ä»£ç†"""
    
    async def _run_async_impl(self, ctx: InvocationContext):
        # æª¢æŸ¥æ˜¯å¦éœ€è¦ HITL å¯©æ‰¹
        if self.requires_approval(ctx):
            approval = await self.request_human_approval(ctx)
            if not approval:
                yield Event(type="remediation_skipped", reason="approval_denied")
                return  # æ—©æœŸçµ‚æ­¢
        
        # åŸ·è¡Œä¿®å¾©
        async for event in self.execute_remediation(ctx):
            yield event
            
            # æª¢æŸ¥æ˜¯å¦æˆåŠŸ
            if event.type == "remediation_success":
                # æ—©æœŸçµ‚æ­¢ï¼Œè·³éå¾ŒçºŒæ­¥é©Ÿ
                ctx.state['skip_remaining'] = True
                return
```

### ğŸ”§ **å…·é«”æ•´åˆå»ºè­°**

#### P0 - ç«‹å³å¯ç”¨çš„æ¨¡å¼

1. **ä¸¦è¡Œè¨ºæ–·å„ªåŒ–**
```python
# æ›¿æ›ç¾æœ‰çš„é †åºè¨ºæ–·ç‚ºä¸¦è¡Œè¨ºæ–·
diagnostic_parallel = ParallelAgent(
    name="parallel_diagnostics",
    sub_agents=[
        PrometheusMetricsAgent(output_key="metrics_diagnosis"),
        ElasticsearchLogAgent(output_key="logs_diagnosis"),
        JaegerTraceAgent(output_key="traces_diagnosis")
    ]
)
```

2. **æ¢ä»¶ä¿®å¾©æµç¨‹**
```python
# åŸºæ–¼é¢¨éšªç­‰ç´šçš„æ¢ä»¶åŸ·è¡Œ
remediation_flow = ConditionalSequentialAgent(
    name="smart_remediation",
    conditions={
        'high_risk': HITLApprovalAgent(),
        'medium_risk': AutoRemediationAgent(),
        'low_risk': ScheduledRemediationAgent()
    }
)
```

#### P1 - çŸ­æœŸæ•´åˆ

1. **è¿­ä»£å„ªåŒ–å¾ªç’°**
```python
# SLO å„ªåŒ–å¾ªç’°
slo_optimizer = LoopAgent(
    name="slo_tuning_loop",
    sub_agent=SLOAdjustmentAgent(),
    max_iterations=5,
    termination_condition=lambda ctx: ctx.state.get('error_budget_healthy', False)
)
```

2. **å‹•æ…‹å°ˆå®¶é¸æ“‡**
```python
# å€Ÿé¡ workflow_triage çš„å‹•æ…‹é¸æ“‡
class DynamicExpertSelector(BaseAgent):
    def select_experts(self, incident_type):
        expert_map = {
            'network': [NetworkExpert(), DNSExpert()],
            'database': [DatabaseExpert(), QueryOptimizer()],
            'kubernetes': [K8sExpert(), PodDebugger()]
        }
        return expert_map.get(incident_type, [GeneralDiagnosticExpert()])
```

### âš ï¸ **éœ€è¦æ³¨æ„çš„åœ°æ–¹**

1. **è¤‡é›œåº¦ç®¡ç†**ï¼šé¿å…éåº¦åµŒå¥—å·¥ä½œæµç¨‹
2. **ç‹€æ…‹åŒæ­¥**ï¼šä¸¦è¡ŒåŸ·è¡Œæ™‚è¦æ³¨æ„ç‹€æ…‹ç«¶çˆ­
3. **éŒ¯èª¤è™•ç†**ï¼šç¢ºä¿æ¯å€‹åˆ†æ”¯éƒ½æœ‰é©ç•¶çš„éŒ¯èª¤è™•ç†
4. **æ€§èƒ½è€ƒé‡**ï¼šéå¤šçš„ä¸¦è¡Œå¯èƒ½å°è‡´è³‡æºç«¶çˆ­

### ğŸ“Š **æ•´åˆå„ªå…ˆç´šå»ºè­°**

| åŠŸèƒ½ | å„ªå…ˆç´š | é æœŸæ•ˆç›Š | å¯¦æ–½é›£åº¦ |
|------|--------|----------|----------|
| ä¸¦è¡Œè¨ºæ–· | P0 | æ¸›å°‘ MTTR 50% | ä½ |
| æ¢ä»¶åŸ·è¡Œ | P0 | æå‡å®‰å…¨æ€§ | ä¸­ |
| å‹•æ…‹å°ˆå®¶é¸æ“‡ | P1 | æå‡æº–ç¢ºç‡ 30% | ä¸­ |
| è¿­ä»£å„ªåŒ– | P1 | SLO æ”¹å–„ 20% | é«˜ |
| è¤‡é›œå·¥ä½œæµç¨‹ | P2 | å®Œæ•´è‡ªå‹•åŒ– | é«˜ |

### ğŸ¯ **çµè«–**

`google-adk-workflows` **éå¸¸é©åˆ** SRE Assistantï¼Œç‰¹åˆ¥æ˜¯ï¼š

1. **ç«‹å³å¯ç”¨**ï¼šParallelAgent ç”¨æ–¼ä¸¦è¡Œè¨ºæ–·
2. **å¿«é€Ÿè¦‹æ•ˆ**ï¼šæ¢ä»¶åŸ·è¡Œæå‡å®‰å…¨æ€§
3. **é•·æœŸåƒ¹å€¼**ï¼šè¤‡é›œå·¥ä½œæµç¨‹ç·¨æ’èƒ½åŠ›

å»ºè­°å¾ P0 çš„ä¸¦è¡Œè¨ºæ–·é–‹å§‹ï¼Œé€æ­¥å¼•å…¥æ›´è¤‡é›œçš„å·¥ä½œæµç¨‹æ¨¡å¼ã€‚é€™å°‡é¡¯è‘—æå‡ SRE Assistant çš„æ•ˆç‡å’Œæ™ºèƒ½åŒ–æ°´å¹³ã€‚