
# ===============================================
# SRE Assistant — ADK 主設定檔（示範版，繁體中文註解）
# 優先序：環境變數 (ADK_* / 其他顯式變數) > 本檔 > 程式內建預設
# 環境變數覆寫規則：
#   - 對應鍵以 ADK_ 前綴 + 大寫 + '.' 改 '_' 方式覆寫，例如：
#       agent.tools_require_approval  -> ADK_AGENT_TOOLS_REQUIRE_APPROVAL=toolA,toolB
#       policy.high_risk_namespaces   -> ADK_POLICY_HIGH_RISK_NAMESPACES=prod,production,prd
# ===============================================

agent:
  # 代理服務的人類可讀名稱；若 Cloud Build 注入 SERVICE_NAME，將以 SERVICE_NAME 覆蓋。
  name: "sre-assistant"
  # 主模型（可被 experts/*.yaml 的 model 覆蓋各專家）。
  model: "gemini-2.0-flash"
  # 規劃器，可與 ADK 官方 BuiltInPlanner 對齊。若環境無安裝 ADK 則以 None 運行。
  planner: "BuiltInPlanner"
  # 單請求最大迭代次數（LoopAgent 常見設定）。
  max_iterations: 10
  # 需人工核可（HITL）的工具清單；也可用 ADK_AGENT_TOOLS_REQUIRE_APPROVAL=... 覆蓋。
  tools_require_approval:
    - "K8sRolloutRestartLongRunningTool"

rbac:
  # 角色對應允許的工具清單；"*" 代表不受限。
  roles:
    viewer: []
    operator: ["rag_search"]
    sre: ["rag_search", "K8sRolloutRestartLongRunningTool", "ingest_text"]
    admin: ["*"]
  # API Key 與角色映射（僅示例）。請改用實際金鑰管理方案。
  apikey_role:
    dev-view: "viewer"
    dev-op: "operator"
    dev-sre: "sre"
    dev-admin: "admin"

policy:
  # 風險等級門檻（若工具自行評估超過此門檻，會觸發 HITL）。可選：low|medium|high|critical
  risk_threshold: "high"
  # 高風險命名空間（K8s）；也可由 ADK_POLICY_HIGH_RISK_NAMESPACES 覆蓋。
  high_risk_namespaces: ["prod", "production", "prd"]

gcp:
  # GCP 專案與區域；若 Cloud Run/Cloud Build 已注入 GOOGLE_CLOUD_PROJECT / CLOUD_RUN_REGION 則以注入值為準。
  project_id: "your-project-id"
  region: "us-central1"

observability:
  # OTLP gRPC 端點（預設為 Google Managed Service for OTel）。
  # 若使用 Cloud Build 部署至 Cloud Run，建議以 substitutions 注入 _OTEL_ENDPOINT 覆蓋。
  otlp_endpoint: "https://otel.googleapis.com:4317"
  # 是否啟用 OTel 初始化（亦可用環境變數 OTEL_ENABLED=false 關閉）。
  enabled: true

server:
  # FastAPI/Uvicorn 相關服務端口與 Host（本地開發用）。
  host: "0.0.0.0"
  port: 8080

experts:
  # 可放置每位專家的輔助預設（通常以 experts/*.yaml 個別覆蓋為主）。
  diagnostic:
    slo:
      p95_response_ms: 2000
  remediation: {}
  postmortem: {}
  config: {}

dev_ui:
  # Dev UI 顯示工具清單來源可與 RBAC/allowlist 同步；此處為預留。
  show_allowlist_from_experts: true
  show_rbac_roles: true
